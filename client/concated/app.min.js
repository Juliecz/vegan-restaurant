function loginPost(){$(document).ready(function(){var a,b;$("#submit").click(function(){a=$("#username").val(),b=$("#password").val(),$.post("http://localhost:3000/admin",{user:a,password:b},function(a){})})})}function initialize(){var a=(new google.maps.DirectionsService,new google.maps.DirectionsRenderer),b=new google.maps.LatLng(50.03855328103505,14.512730911374092),c={zoom:12,mapTypeId:google.maps.MapTypeId.ROADMAP,center:b},d=new google.maps.Map(document.getElementById("map"),c),e=new google.maps.Marker({position:b,map:d,title:"Veganska restaurace",animation:google.maps.Animation.DROP});a.setMap(d,e)}function initH1(){document.getElementById("h1Kontrola").innerHTML="caaaaau"}function FindAll(a){Drink.find(function(b,c){b&&a.send(b),a.json(c)})}function findAllFunc(a){Menu.find(function(b,c){b&&a.send(b),a.json(c)})}function randomPassword(){for(var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",b="",c=7,d=0;c>d;d++){var e=Math.floor(Math.random()*a.length);b+=a.substring(e,e+1)}return b}angular.module("veganapp.admin").controller("headCtrl",["$scope","authProvider",function(a,b){}]),angular.module("veganapp.admin").controller("dailyMenuCtrl",["$scope","$state","$stateParams","$window","dailyMenuAdmin",function(a,b,c,d,e){a.day=["Pondělí","Úterý","Středa","Čtvrtek","Pátek"],a.dayObj=[],a.activeTab="pondeli",a.actions={"new":"Pridat nove jidlo",edit:"Upravit jidlo"},a.days=[{id:"pondeli",name:"Pondělí"},{id:"utery",name:"Úterý"},{id:"streda",name:"Středa"},{id:"ctvrtek",name:"Čtvrtek"},{id:"patek",name:"Pátek"}],e.getDay().success(function(b,c){a.datum=b,console.log("Status getday: ",c)}),e.getDailyMenu().success(function(b,c){if(a.data=b,a.data&&a.datum){for(var d=0;d<a.day.length;d++)a.dayObj.push({name:a.datum[d],text:a.day[d]});console.log("Day arr object",a.dayObj)}}),e.getSort().success(function(b,c){a.typ=b,console.log("Typ: ",a.typ)}),a.setAction=function(d,f){c.action=d,c.id=f;var g={};"new"==c.action?(g={action:c.action,actionName:a.actions["new"],id:f,object:{},menuType:"daily",day:a.activeTab},c.actionName=a.actions["new"],b.go("admin.edit",g)):"edit"==c.action?e.getById(f).success(function(d,e){g={action:c.action,actionName:a.actions.edit,id:f,object:d,menuType:"daily"},b.go("admin.edit/:id",g)}):"delete"==c.action,console.log(g)},a.activeTab="pondeli",a.setTab=function(b){a.activeTab=b}}]),angular.module("veganapp.admin").controller("editCtrl",["$scope","$state","$stateParams","getMenu","dailyMenuAdmin","drinkMenu","userFactory",function(a,b,c,d,e,f,g){switch(a.typMenu=["Staly jídelní lístek","Polední menu","Nápojový lístek"],a.typMenuId=["menu","daily","drink","user"],a.role=["admin","employee"],a.typMenuSelected=c.action,c.menuType){case"menu":"new"==c.action?a.action="Přidat nové jídlo do jídelního lístku":"edit"==c.action&&(a.action="Upravit jídlo");break;case"daily":"new"==c.action?a.action="Přidat nové jídlo do poledního menu":"edit"==c.action&&(a.action="Upravit jídlo v poledním menu");break;case"drink":"new"==c.action?a.action="Přidat nový nápoj":"edit"==c.action&&(a.action="Upravit nápoj");break;case"user":"new"==c.action?a.action="Nový uživatel":"edit"==c.action&&(a.action="Úprava osobních údajů");break;default:b.go("admin.menu")}e.getDay().success(function(b,c){a.den=b}),d.getFood().success(function(b,c){a.dataMenu=b,console.log(c),console.log(a.dataMenu)}),d.getSort().success(function(b){a.trida=b}),d.getTyp().success(function(b){a.typ=b}),f.getSort().success(function(b){a.sortDrink=b}),"edit"==c.action?"daily"==c.menuType||"menu"==c.menuType?(a.formData={jmeno:c.object.foodName,popis:c.object.foodDescription,typ:c.object.foodType,trida:c.object.foodSort,cena:c.object.price},"menu"==c.menuType?a.formData.typMenu=a.typMenuId[0]:"daily"==c.menuType&&(a.formData.typMenu=a.typMenuId[1],a.formData.den=c.object.day)):"drink"==c.menuType?f.getById(c.id).success(function(b){a.formData={jmeno:b.drinkName,popis:b.drinkDescription,trida:b.drinkSort,cena:b.price,typMenu:a.typMenuId[2]}}):"user"==c.menuType&&g.getUserById(c.id).success(function(b){a.formData={uzivJm:b.username,jm:b.name,prijm:b.surname,role:b.role,phone:b.phone,email:b.email,typMenu:"user"}}):"new"==c.action&&(a.formData={jmeno:"",popis:"",typ:"",trida:"",cena:""},"menu"==c.menuType?a.formData.typMenu=a.typMenuId[0]:"daily"==c.menuType?(a.formData.typMenu=a.typMenuId[1],a.formData.den=c.day):"drink"==c.menuType?a.formData.typMenu=a.typMenuId[2]:"user"==c.menuType&&(a.formData.typMenu="user")),a.sendPost=function(){"new"==c.action?a.createFood(a.formData):"edit"==c.action&&a.editFood(a.formData)},a.createFood=function(a){if(a)switch(console.log(c.menuType),c.menuType){case"menu":d.createFood(a).success(function(a){console.log(a)}),b.go("admin.menu");break;case"daily":e.createFood(a).success(function(a){console.log(a)}),b.go("admin.dailyMenu");break;case"drink":f.createDrink(a).success(function(a){console.log(a)}),b.go("admin.menu");break;case"user":g.createUser(a).success(function(a){}),b.go("admin.users")}},a.editFood=function(a){if(a)switch(c.menuType){case"menu":d.updateFood(c.id,a).success(function(a){console.log(a)}),b.go("admin.menu");break;case"daily":console.log(a),e.editFood(a,c.id).success(function(a){console.log(a)}),b.go("admin.dailyMenu");break;case"drink":f.updateDrink(a,c.id).success(function(a){}),b.go("admin.menu");break;case"user":g.updateUser(c.id,a).success(function(a){}),b.go("admin.users")}}}]),angular.module("veganapp.admin").controller("homeCtrlA",["$scope","$http","$stateParams","authProvider",function(a,b,c,d){}]),angular.module("veganapp.admin").controller("loginCtrl",["$scope","$state","$http","$rootScope","$location","authProvider",function(a,b,c,d,e,f){a.user={},a.login=function(){f.login(a.user.username,a.user.password).then(function(a){b.go("admin")})["catch"](function(){a.outputData="Zadejte spravne udaje"})}}]),angular.module("veganapp.admin").controller("meCtrl",["$scope","$state","authProvider","userFactory",function(a,b,c,d){a.myInfo=function(){c.isLoggedIn().then(function(b){d.getUserById(b.data).success(function(b){a.me={id:b._id,uzivJm:b.username,jm:b.name,prijm:b.surname,role:b.role,email:b.email,phone:b.phone,phoneM:b.phoneMessage,emailM:b.emailMessage},console.log(b)})})},a.myInfo(),a.send=function(b,c){d.updateUser(b,c).success(function(b){a.myInfo()})}}]),angular.module("veganapp.admin").controller("menuCtrl",["$scope","$state","$stateParams","getMenu","drinkMenu",function(a,b,c,d,e){a.activeTab="jidelni",a.setTab=function(b){a.activeTab=b,"jidelni"==a.activeTab?a.actions={"new":"Přidat nové jídlo",edit:"Upravit jídlo"}:a.actions={"new":"Přidat nový nápoj",edit:"Upravit nápoj"}},"jidelni"==a.activeTab?a.actions={"new":"Přidat nové jídlo",edit:"Upravit jídlo"}:a.actions={"new":"Přidat nový nápoj",edit:"Upravit nápoj"},a.dataMenu={},a.typ={},a.trida={},a.tridaVar=[],d.getFood().success(function(b,c){a.dataMenu=b}),d.getTyp().success(function(b,c){a.typ=b}),d.getSort().success(function(b,c){if(a.trida=b,a.trida)for(var d=0;d<a.trida.length;d++)"predkrm"==a.trida[d]?a.tridaVar.push({name:"predkrm",text:"Předkrmy"}):"hlavni"==a.trida[d]?a.tridaVar.push({name:"hlavni",text:"Hlavní chody"}):"salat"==a.trida[d]?a.tridaVar.push({name:"salat",text:"Saláty"}):"dezert"==a.trida[d]&&a.tridaVar.push({name:"dezert",text:"Dezerty"})}),e.getDrinks().success(function(b){a.drinks=b}),a.setAction=function(e,f,g){c.action=e,c.id=f;var h={};if("new"==c.action)h={action:c.action,actionName:a.actions["new"],id:c.id,object:{},menuType:g},c.actionName=a.actions["new"],b.go("admin.edit",h);else if("edit"==c.action){for(var i=0;i<a.dataMenu.length;i++)if(a.dataMenu[i]._id==c.id){a.editFoodObj=a.dataMenu[i];break}h={action:c.action,actionName:a.actions.edit,id:c.id,object:a.editFoodObj,menuType:g},b.go("admin.edit/:id",h)}else"delete"==c.action&&(h={action:c.action,actionName:"delete",id:c.id},d.removeFood(h.id),d.getFood().success(function(b,c){a.dataMenu=b}))}}]),angular.module("veganapp.admin").controller("reservationCtrl",["$scope","getTable","reservationFactory",function(a,b,c){a.setTab=function(b){a.activeTab=b},a.month=["Leden","Únor","Březen","Duben","Květen","Červen","Červenec","Srpen","Září","Říjen","Listopad","Prosinec"],a.weeks=["Po","Út","St","Čt","Pá","So","Ne"],a.today=new Date,a.activeTab=a.today.getDate(),a.Calendar=new Calendar(1),a.mdays=a.Calendar.monthDays(a.today.getFullYear(),a.today.getMonth()),console.log(a.mdays),a.startDayWeek=a.Calendar.weekStartDate(a.today),b.getTables().success(function(b){a.tables=b}),c.getReservations().success(function(b){a.reservations=b}),a.arr=[0,1,2,3,4,5,6],a.todayChosen=new Date,a.filterDay=function(a){return 0!==a},a.firstDayInWeek=a.Calendar.weekStartDate(a.today),a.lastDayInWeek=new Date(a.firstDayInWeek.getFullYear(),a.firstDayInWeek.getMonth(),a.firstDayInWeek.getDate()+7),a.nextMonth=function(b){if(11>b){if(a.today.getDate()>a.Calendar.lastDayInMonth(a.today.getFullYear(),b+1)){var c=a.Calendar.lastDayInMonth(a.today.getFullYear(),b+1);a.today.setDate(c),a.selected=c}a.today.setMonth(b+1),a.mdays=a.Calendar.monthDays(a.today.getFullYear(),a.today.getMonth())}else 11===b&&(a.today.setMonth(0),a.today.setFullYear(a.today.getFullYear()+1),a.mdays=a.Calendar.monthDays(a.today.getFullYear(),a.today.getMonth()))},a.prevMonth=function(b){var c,d=new Date;a.today.getFullYear()>=d.getFullYear()&&(b>d.getMonth()&&a.today.getFullYear()===d.getFullYear()?(a.today.getDate()>a.Calendar.lastDayInMonth(a.today.getFullYear(),b-1)&&(c=a.Calendar.lastDayInMonth(a.today.getFullYear(),b-1),a.today.setDate(c),a.selected=c),a.today.setMonth(b-1),a.mdays=a.Calendar.monthDays(a.today.getFullYear(),a.today.getMonth())):a.today.getFullYear()>d.getFullYear()&&(0===b?(a.today.setMonth(11),a.today.setFullYear(a.today.getFullYear()-1),a.mdays=a.Calendar.monthDays(a.today.getFullYear(),a.today.getMonth())):(a.today.getDate()>a.Calendar.lastDayInMonth(a.today.getFullYear(),b-1)&&(c=a.Calendar.lastDayInMonth(a.today.getFullYear(),b-1),a.today.setDate(c),a.selected=c),a.today.setMonth(b-1),a.mdays=a.Calendar.monthDays(a.today.getFullYear(),a.today.getMonth()))))},a.onclickDate=function(b,c,d){a.today=new Date(d,c,b),a.selected=b,a.showSecondTable=!0,a.firstDayInWeek=a.Calendar.weekStartDate(a.today),a.lastDayInWeek.setDate(a.firstDayInWeek.getDate()+6)},a.dnes=function(a,b,c){var d=new Date;return d.getDate()===a&&d.getMonth()===b&&d.getFullYear()===c?d.getDate():-1}}]),angular.module("veganapp.admin").controller("usersCtrl",["$scope","$state","$stateParams","$window","getMenu","dailyMenuAdmin","userFactory","authProvider",function(a,b,c,d,e,f,g,h){h.isLoggedIn().then(function(c){g.getUserById(c.data).success(function(c){a.me=c,"employee"===c.role&&b.go("admin.me")})}),g.getAllUsers().success(function(b){a.users=b}),a.setAction=function(c,d,e){var f={};"user"===e&&("delete"===c?(g.deleteUser(d),g.getAllUsers().success(function(b){a.users=b})):"edit"===c?(f={action:c,id:d,menuType:e},b.go("admin.edit/:id",f)):"new"===c&&(f={action:c,id:d,menuType:e},b.go("admin.edit",f)))}}]),angular.module("veganapp.admin").config(["$stateProvider","$urlRouterProvider",function(a,b){a.state("admin",{url:"/admin",views:{main:{templateUrl:"/views/admin/content.html",controller:"headCtrlA"}},resolve:{loggedInResolve:function(a,b){a.isLoggedIn().then(function(a){""!==a.data&&"0"!==a.data?b.go("admin.home"):b.go("login")},function(){b.go("login")})}},abstact:!0}).state("admin.home",{url:"/home",views:{admin:{templateUrl:"/views/admin/home.html",controller:"homeCtrlA"}}}).state("admin.me",{url:"/me",views:{admin:{templateUrl:"/views/admin/me.html",controller:"meCtrl"}}}).state("admin.users",{url:"/users",views:{admin:{templateUrl:"/views/admin/users.html",controller:"usersCtrl"}}}).state("admin.menu",{url:"/menu",views:{admin:{templateUrl:"/views/admin/menu.html",controller:"menuCtrl"}}}).state("admin.dailyMenu",{url:"/dailyMenu",views:{admin:{templateUrl:"/views/admin/dailyMenu.html",controller:"dailyMenuCtrl"}}}).state("admin.reservation",{url:"/reservation",views:{admin:{templateUrl:"/views/admin/reservation.html",controller:"reservationCtrl"}}}).state("admin.edit",{url:"/edit",views:{admin:{templateUrl:"/views/admin/edit.html",controller:"editCtrl"}},params:{action:null,actionName:null,id:null,object:{},menuType:null,day:null}}).state("admin.edit/:id",{url:"/edit/:id",views:{admin:{templateUrl:"/views/admin/edit.html",controller:"editCtrl"}},params:{action:null,actionName:null,id:null,object:{},menuType:null}}).state("login",{url:"/login",views:{main:{templateUrl:"/views/admin/login.html",controller:"loginCtrl"}},resolve:{loggedInResolve:function(a,b){a.isLoggedIn().then(function(a){console.log("resolve is running: ",a.data),""!==a.data&&"0"!==a.data?b.go("admin.home"):b.go("login")},function(){b.go("login")})}}})}]).run(["$state","$rootScope","$location","authProvider",function(a,b,c,d){}]).controller("headCtrlA",["$scope","$state","$stateParams","$location","$window","$document","authProvider","userFactory",function(a,b,c,d,e,f,g,h){a.logout=function(){g.logout().then(function(){d.url("/home")})},g.isLoggedIn().then(function(b){h.getUserById(b.data).success(function(b){console.log("Data from server: ",b),a.uzivatel=b})}),a.winSize=e.innerWidth,a.resizeWin=function(){e.innerWidth<768?(a.showLeftMenu=!1,a.classSmallScreen="smallScreen"):(a.showLeftMenu=!0,a.classSmallScreen="")},a.resizeWin(),$(window).resize(function(){a.$apply(function(){a.resizeWin(),a.winSize=e.innerWidth})}),a.showHideLeftMenu=function(){e.innerWidth<768&&(a.showLeftMenu?a.showLeftMenu=!1:a.showLeftMenu=!0,"smallScreen"===a.classSmallScreen?a.classSmallScreen="":a.classSmallScreen="smallScreen")},a.clickSection=function(){e.innerWidth<768&&(a.showLeftMenu=!1,a.classSmallScreen="smallScreen")}}]),angular.module("veganapp.admin").factory("dailyMenuAdmin",function(a){return{getDailyMenu:function(){return a.get("/api/dailymenu").success(function(a){this.jsonData=a})},getDay:function(){return a.get("/api/dailymenu/day").success(function(a){this.jsonData=a})},getType:function(){return a.get("/api/dailymenu/type").success(function(a){this.jsonData=a})},getSort:function(){return a.get("/api/dailymenu/sort").success(function(a){this.jsonData=a})},getById:function(b){return a.get("/api/dailymenu/id/"+b).success(function(a){this.jsonData=a})},createFood:function(b){return a.post("/api/dailymenu",{foodName:b.jmeno,foodDescription:b.popis,foodType:b.typ,foodSort:b.trida,price:b.cena,day:b.den})},editFood:function(b,c){return a.put("/api/dailymenu/"+c,{foodName:b.jmeno,foodDescription:b.popis,foodType:b.typ,foodSort:b.trida,price:b.cena,day:b.den})}}}),angular.module("veganapp.admin").factory("getMenu",function(a){return{getFood:function(){return a.get("/api/menu").success(function(a){this.jsonData=a})},getSort:function(){return a.get("/api/menu/sort").success(function(a){this.jsonData=a})},getTyp:function(){return a.get("/api/menu/type").success(function(a){this.jsonData=a})},createFood:function(b){return a.post("/api/menu",{foodName:b.jmeno,foodDescription:b.popis,foodType:b.typ,foodSort:b.trida,price:b.cena})},removeFood:function(b){return a["delete"]("/api/menu/"+b,{id:b})},updateFood:function(b,c){return a.put("/api/menu/"+b,{id:b,foodName:c.jmeno,foodDescription:c.popis,foodType:c.typ,foodSort:c.trida,price:c.cena})}}}),angular.module("veganapp.admin").factory("userFactory",function(a){return{getUserById:function(b){return a.get("/api/user/"+b,{id:b}).success(function(a){this.jsonData=a})},getAllUsers:function(){return a.get("/api/user").success(function(a){this.jsonData=a})},createUser:function(b){return a.post("/api/user",{username:b.uzivJm,name:b.jm,surname:b.prijm,role:b.role,email:b.email,phone:b.phone})},deleteUser:function(b){return a["delete"]("/api/user/"+b,{id:b})},updateUser:function(b,c){return a.put("/api/user/"+b,{id:b,username:c.uzivJm,name:c.jm,surname:c.prijm,role:c.role,email:c.email,phone:c.phone,emailMessage:c.emailM,phoneMessage:c.phoneM})}}}),angular.module("veganapp.public",["veganapp.system"]),angular.module("veganapp.admin",["veganapp.system"]);var myApp=angular.module("veganapp",["veganapp.public","veganapp.admin","veganapp.system"]);myApp.config(["$stateProvider","$urlRouterProvider",function(a,b){a.state("root",{views:{main:{controller:["$state","$injector",function(a,b){}]}}}),b.otherwise("/home")}]).controller("contentCtrl",function(a,b,c){a.setContent=function(){},$(window).resize(function(){})}).run(["$location","$state",function(a,b){}]),angular.module("veganapp.admin").factory("authProvider",["$q","$timeout","$http","$location",function(a,b,c,d){return{login:function(a,b){return c.post("/api/login",{username:a,password:b}).success(function(a,b){return a}).error(function(){return 0})},isLoggedIn:function(){return c.get("/api/logged").success(function(a,b){return a}).error(function(){return 0})},logout:function(){return c.get("/api/logout").success(function(a,b){return a}).error(function(){return 0})}}}]),angular.module("veganapp").factory("drinkMenu",["$http",function(a){return{getDrinks:function(){return a.get("/api/drinkmenu").success(function(a){this.jsonData=a})},createDrink:function(b){return a.post("/api/drinkmenu",{drinkName:b.jmeno,drinkDescription:b.popis,drinkType:b.typ,drinkSort:b.trida,price:b.cena})},removeDrink:function(){return a["delete"]("/api/drinkmenu/"+id,{id:id})},updateDrink:function(b,c){return a.put("/api/drinkmenu/"+c,{id:c,drinkName:b.jmeno,drinkDescription:b.popis,drinkType:b.typ,drinkSort:b.trida,price:b.cena})},getById:function(b){return a.get("/api/drinkmenu/id/"+b,{id:b}).success(function(a){this.jsonData=a})},getSort:function(){return a.get("/api/drinkmenu/sort").success(function(a){this.jsonData=a})}}}]),angular.module("veganapp.public").controller("orderCtrl",function(a){}),angular.module("veganapp.public").controller("contactCtrl",function(a){initH1()}),angular.module("veganapp.public").controller("homeCtrl",function(a){a.test="testovani"}),angular.module("veganapp.public").controller("menuCtrlP",["$scope","$http","menuPublic","drinkMenu",function(a,b,c,d){switch(a.today=(new Date).getDay(),0===a.today||6===a.today?a.vikend=!0:a.vikend=!1,a.tridaVar=[],a.poledni=[],a.todayStr="Pro dnešní den není žádné polední menu.",a.today){case 1:a.todayStr="pondeli";break;case 2:a.todayStr="utery";break;case 3:a.todayStr="streda";break;case 4:a.todayStr="ctvrtek";break;case 5:a.todayStr="patek"}a.tridaDaily=[{name:"polevka",text:"Polévka"},{name:"hlavni",text:"Hlavní chody"}],c.getMenu().success(function(b,c){a.data=b}),c.getDailyMenu().success(function(b,c){for(var d=0;d<b.length;d++)b[d].day===a.todayStr&&a.poledni.push(b[d])}),c.getSort().success(function(b,c){if(a.trida=b,a.amount=a.trida.length,a.trida)for(var d=0;d<a.trida.length;d++)"predkrm"==a.trida[d]?a.tridaVar.push({name:"predkrm",text:"Předkrmy"}):"hlavni"==a.trida[d]?a.tridaVar.push({name:"hlavni",text:"Hlavní chody"}):"salat"==a.trida[d]?a.tridaVar.push({name:"salat",text:"Saláty"}):"dezert"==a.trida[d]&&a.tridaVar.push({name:"dezert",text:"Dezerty"})}),d.getDrinks().success(function(b){a.napojovy=b}),a.tabs=[{title:"Polední menu",template:"poledni"},{title:"Jídelní lístek",template:"jidelni"},{title:"Nápojový lístek",template:"napojovy"}],a.activeTab="jidelni",a.setTab=function(b){a.activeTab=b}}]),angular.module("veganapp.public").controller("tablesCtrl",["$scope","getTable","reservationFactory",function(a,b,c){a.tableObj=[],a.availability=[],b.getTables().success(function(b,c){for(var d=0;d<b.length;d++)a.tableObj.push({table:b[d],checked:!1}),a.availability.push({table:b[d]._id,free:!0})}),a.updateTables=function(a,b){angular.forEach(b,function(b,c){a!=c&&(b.checked=!1)})},a.myNumber=5,a.getNumber=function(a){return new Array(a)},a.showSecondTable=!1,a.month=["Leden","Únor","Březen","Duben","Květen","Červen","Červenec","Srpen","Září","Říjen","Listopad","Prosinec"],a.weeks=["Po","Út","St","Čt","Pá","So","Ne"],a.today=new Date,a.datum=new Date,a.Calendar=new Calendar(1),a.mdays=a.Calendar.monthDays(a.today.getFullYear(),a.today.getMonth()),a.filterDay=function(a){return 0!==a},a.firstDayInWeek=a.Calendar.weekStartDate(a.today),a.lastDayInWeek=new Date(a.firstDayInWeek.getFullYear(),a.firstDayInWeek.getMonth(),a.firstDayInWeek.getDate()+7),a.reservation={day:a.today.getDate(),month:a.today.getMonth(),year:a.today.getFullYear()},a.changeTime=function(){(!a.reservation.endTime||parseInt(a.reservation.endTime)<=parseInt(a.reservation.startTime))&&(a.reservation.endTime=(parseInt(a.reservation.startTime)+1).toString())},a.checkendTime=function(){var b=parseInt(a.reservation.startTime),c=parseInt(a.reservation.endTime);b>=c&&(b=c-1,a.reservation.startTime=b.toString())},a.nextMonth=function(b){if(11>b){if(a.today.getDate()>a.Calendar.lastDayInMonth(a.today.getFullYear(),b+1)){var c=a.Calendar.lastDayInMonth(a.today.getFullYear(),b+1);a.today.setDate(c),a.selected=c}a.today.setMonth(b+1),a.mdays=a.Calendar.monthDays(a.today.getFullYear(),a.today.getMonth())}else 11===b&&(a.today.setMonth(0),a.today.setFullYear(a.today.getFullYear()+1),a.mdays=a.Calendar.monthDays(a.today.getFullYear(),a.today.getMonth()))},a.prevMonth=function(b){var c,d=new Date;a.today.getFullYear()>=d.getFullYear()&&(b>d.getMonth()&&a.today.getFullYear()===d.getFullYear()?(a.today.getDate()>a.Calendar.lastDayInMonth(a.today.getFullYear(),b-1)&&(c=a.Calendar.lastDayInMonth(a.today.getFullYear(),b-1),a.today.setDate(c),a.selected=c),a.today.setMonth(b-1),a.mdays=a.Calendar.monthDays(a.today.getFullYear(),a.today.getMonth())):a.today.getFullYear()>d.getFullYear()&&(0===b?(a.today.setMonth(11),a.today.setFullYear(a.today.getFullYear()-1),a.mdays=a.Calendar.monthDays(a.today.getFullYear(),a.today.getMonth())):(a.today.getDate()>a.Calendar.lastDayInMonth(a.today.getFullYear(),b-1)&&(c=a.Calendar.lastDayInMonth(a.today.getFullYear(),b-1),a.today.setDate(c),a.selected=c),a.today.setMonth(b-1),a.mdays=a.Calendar.monthDays(a.today.getFullYear(),a.today.getMonth()))))},a.onclickDate=function(b,c,d){a.datum=new Date(d,c,b),a.selected=b,a.firstDayInWeek=a.Calendar.weekStartDate(a.today),a.lastDayInWeek.setDate(a.firstDayInWeek.getDate()+6),a.reservation={day:a.datum.getDate(),month:a.datum.getMonth(),year:a.datum.getFullYear()}},a.dnes=function(a,b,c){var d=new Date;return d.getDate()===a&&d.getMonth()===b&&d.getFullYear()===c?d.getDate():-1},a.showMonth=function(){a.showSecondTable=!1},a.reservationsForCurrentDay=function(){a.resForCurrentDay=[],c.getReservations().success(function(b){for(var c=0;c<b.length;c++){var d=new Date(b[c].startDate);a.datum.getDate()==d.getDate()&&a.datum.getMonth()==d.getMonth()&&a.datum.getFullYear()==d.getFullYear()&&a.resForCurrentDay.push(b[c])}a.resForCurrentDay.length>0?(console.log("ano"),a.checkReservation(a.resForCurrentDay)):console.log("ne")})},a.checkReservation=function(b){for(var c=0;c<a.availability.length;c++)for(var d=0;d<b.length;d++)a.availability[c].table===b[d].table&&console.log(a.availability[c].table,"____",b[d].table)},a.checkReservation(a.reservation),a.sendReservation=function(b){var d=new Date(b.year,b.month,b.day,b.startTime),e=new Date(b.year,b.month,b.day,b.endTime);c.createReservation(a.reservation,d,e),console.log(d,"____",e)}}]),angular.module("veganapp.public").config(["$stateProvider","$urlRouterProvider",function(a,b){a.state("public",{url:"",views:{main:{templateUrl:"/views/public/content.html",controller:"headCtrlP"}},"abstract":!0}).state("public.home",{url:"/home",views:{"public":{templateUrl:"/views/public/home.html",controller:"homeCtrl"}}}).state("public.menu",{url:"/menu",views:{"public":{templateUrl:"/views/public/menu.html",controller:"menuCtrlP"}}}).state("public.contact",{url:"/contact",views:{"public":{templateUrl:"/views/public/contact.html",controller:"contactCtrl"}}}).state("public.reservation",{url:"/reservation",views:{"public":{templateUrl:"/views/public/tables.html",controller:"tablesCtrl"}}})}]).run(["$rootScope","$state",function(a,b){a.$state=b,b.go("public.home")}]),angular.module("veganapp.public").controller("headCtrlP",["$scope","$http","$rootScope",function(a,b,c){}]),angular.module("veganapp.public").factory("menuPublic",function(a){return{getMenu:function(){return a.get("/api/menu").success(function(a){this.jsonMenu=a})},getSort:function(){return a.get("/api/menu/sort").success(function(a){this.jsonData=a})},getDailyMenu:function(){return a.get("/api/dailymenu").success(function(a){this.jsonData=a})}}}),angular.module("veganapp.public").factory("getTable",function(a){return{getTables:function(){return a.get("/api/table").success(function(a){this.jsonTables=a})}}}),angular.module("veganapp").factory("reservationFactory",["$http",function(a){return{getReservations:function(){return a.get("/api/reservation").success(function(a){this.jsonData=a})},createReservation:function(b,c,d){return a.post("/api/reservation",{jmeno:b.jmeno,prijmeni:b.prijmeni,tableId:b.table,email:b.email,tel:b.tel,startDate:c,endDate:d})},deleteReservation:function(b){return a["delete"]("/api/reservation/"+b)},updateReservation:function(b,c,d){return a.put("/api/reservation",{jmeno:b.jmeno,prijmeni:b.prijmeni,tableId:b.table,email:b.email,tel:b.tel,startDate:c,endDate:d})}}}]),angular.module("veganapp.system",["ui.router","ui.router.stateHelper","ui.bootstrap","ngRoute"]);var mongoose=require("mongoose"),config=require("./config"),dbMongo=mongoose.createConnection(config.mongoose.uri);dbMongo.on("error",console.error),dbMongo.once("open",function(){console.log("Connected to database")}),module.exports=dbMongo;var nconf=require("nconf"),path=require("path");nconf.argv().env().file({file:path.join(__dirname,"config.json")}),module.exports=nconf;var mongoose=require("mongoose"),passport=require("passport"),LocalStrategy=require("passport-local").Strategy,connection=require("../config/database"),userSchema=require("../models/user"),User=connection.model("User",userSchema);config=require("./config"),module.exports=function(a){a.serializeUser(function(a,b){b(null,a.id)}),a.deserializeUser(function(a,b){User.findById(a,function(a,c){b(a,c)})}),a.use(new LocalStrategy({username:"username",password:"password"},function(a,b,c){User.findOne({username:a},function(a,d){return a?(console.log("Chyba: local strategy"),c(a)):d?d.password!==b?c(null,!1,{message:"Incorrect password"}):c(null,d):c(null,!1,{message:"Incorrect username"})})}))};var index=require("../controllers/index"),admin=require("../controllers/admin"),menu=require("../controllers/menu"),users=require("../controllers/user"),tables=require("../controllers/table"),dailyMenu=require("../controllers/dailyMenu"),drinks=require("../controllers/drinkMenu"),reservation=require("../controllers/reservation"),auth=require("../controllers/authenticate"),passport=require("passport"),LocalStrategy=require("passport-local").Strategy;module.exports=function(a,b){a.get("/",index.render),a.get("/admin",admin.render),a.get("/api/menu",menu.findAll),a.post("/api/menu",menu.createFood),a.get("/api/menu/type",menu.enumType),a.get("/api/menu/sort",menu.enumSort),a.put("/api/menu/:id",menu.editFood),a["delete"]("/api/menu/:id",menu.deleteFood),a.get("/api/drinkmenu",drinks.findAll),a.get("/api/drinkmenu/sort",drinks.enumSort),a.get("/api/drinkmenu/id/:id",drinks.getById),a.put("/api/drinkmenu/:id",drinks.editDrink),a.post("/api/drinkmenu",drinks.createDrink),a["delete"]("/api/drinkmenu/:id",drinks.deleteDrink),a.get("/api/dailymenu",dailyMenu.findAll),a.get("/api/dailymenu/id/:id",dailyMenu.findById),a.get("/api/dailymenu/day",dailyMenu.enumDay),a.get("/api/dailymenu/type",dailyMenu.enumType),a.get("/api/dailymenu/sort",dailyMenu.enumSort),a.put("/api/dailymenu/:id",dailyMenu.editFood),a["delete"]("/api/dailymenu/:id",dailyMenu.deleteFood),a.post("/api/dailymenu",dailyMenu.createFood),a.get("/api/user",auth.checkAuthenticate,users.findAll),a.get("/api/user/:id",users.findUserById),a.post("/api/user",users.createUser),a.put("/api/user/:id",users.editUser),a["delete"]("/api/user/:id",users.deleteUser),a.get("/api/table",tables.findAll),a.get("/api/reservation",reservation.findAll),a.post("/api/reservation",reservation.createReservation),a["delete"]("/api/reservation/:id",reservation.deleteReservation),a.put("/api/reservation/:id",reservation.editReservation),a.post("/api/login",b.authenticate("local"),auth.login),a.get("/api/logged",auth.logged),a.get("/api/logout",auth.logout)};var User=require("../models/user");exports.render=function(a,b,c){b.render("admin",{title:"Vegan Restaurant"})};var local=require("passport-local").Strategy,passport=require("passport");exports.login=function(a,b){console.log(a.body),b.send(a.body)},exports.logout=function(a,b){a.logout(),b.redirect("/")},exports.checkAuthenticate=function(a,b,c){a.isAuthenticated()?c():b.render("404")},exports.logged=function(a,b){a.isAuthenticated()?console.log("Logged: ",a.session.passport.user):console.log("Not logged"),b.send(a.isAuthenticated()?a.session.passport.user:0)};var connection=require("../config/database"),dailyMenuSchema=require("../models/dailyMenu");DailyMenu=connection.model("DailyMenu",dailyMenuSchema),exports.findAll=function(a,b,c){DailyMenu.find(function(a,c){a&&b.send(a),b.json(c)})},exports.findById=function(a,b){DailyMenu.findById(a.params.id,function(a,c){a?b.send(a):b.json(c)})},exports.enumDay=function(a,b){var c=DailyMenu.schema.path("day").enumValues;b.send(JSON.stringify(c))},exports.enumSort=function(a,b){var c=DailyMenu.schema.path("foodSort").enumValues;b.send(JSON.stringify(c))},exports.enumType=function(a,b){var c=DailyMenu.schema.path("foodType").enumValues;b.send(JSON.stringify(c))},exports.editFood=function(a,b){DailyMenu.findByIdAndUpdate(a.params.id,{$set:a.body},function(a,c){a&&(console.log(a),b.send(a))})},exports.deleteFood=function(a,b){DailyMenu.findByIdAndRemove(a.params.id,function(a,c){a?b.send(a):DailyMenu.find(function(a,c){a&&b.send(a),b.json(c)})})},exports.createFood=function(a,b){var c=Number(a.body.price),d=DailyMenu({foodName:a.body.foodName,foodDescription:a.body.foodDescription,foodType:a.body.foodType,foodSort:a.body.foodSort,day:a.body.day,price:c});d.save(function(a,c){a?b.send(a):DailyMenu.find(function(a,c){a&&b.send(a),b.json(c)})})};var connection=require("../config/database"),drinkMenuSchema=require("../models/drinkMenu");Drink=connection.model("Drink",drinkMenuSchema),exports.findAll=function(a,b,c){FindAll(b)},exports.getById=function(a,b){Drink.findById(a.params.id,function(a,c){a?b.send(a):b.json(c)})},exports.createDrink=function(a,b){var c=Drink({drinkName:a.body.drinkName,drinkDescription:a.body.drinkDescription,drinkType:a.body.drinkType,drinkSort:a.body.drinkSort,price:a.body.price});c.save(function(a,c){a?b.send(a):FindAll(b)})},exports.deleteDrink=function(a,b){Drink.findByIdAndRemove(a.params.id,function(a){a?b.send(a):FindAll(b)})},exports.editDrink=function(a,b){Drink.findByIdAndUpdate(a.body.id,{$set:a.body},function(a){a?b.send(a):FindAll(b)})},exports.enumSort=function(a,b,c){var d=Drink.schema.path("drinkSort").enumValues;b.send(JSON.stringify(d))};var Menu=require("../models/menu");exports.render=function(a,b,c){b.render("index",{title:"Vegan Restaurant"})};var connection=require("../config/database"),menuSchema=require("../models/menu");Menu=connection.model("Menu",menuSchema),exports.findAll=function(a,b,c){findAllFunc(b)},exports.createFood=function(a,b,c){var d=Number(a.body.price),e=Menu({foodName:a.body.foodName,foodDescription:a.body.foodDescription,foodType:a.body.foodType,foodSort:a.body.foodSort,price:d});e.save(function(a,c){a&&b.send(a),findAllFunc(b)})},exports.enumType=function(a,b,c){var d=Menu.schema.path("foodType").enumValues;b.send(JSON.stringify(d))},exports.enumSort=function(a,b,c){var d=Menu.schema.path("foodSort").enumValues;b.send(JSON.stringify(d))},exports.deleteFood=function(a,b,c){Menu.findByIdAndRemove(a.params.id,function(a){a&&b.send(a)})},exports.editFood=function(a,b){Menu.findByIdAndUpdate(a.body.id,{$set:a.body},function(a,c){a&&b.send(a)})};var connection=require("../config/database"),resSchema=require("../models/reservation"),Reservation=connection.model("Reservation",resSchema);
exports.createReservation=function(a,b){var c=Number(a.body.tel),d=Reservation({startDate:a.body.startDate,endDate:a.body.endDate,table:a.body.tableId,name:a.body.jmeno,surname:a.body.prijmeni,email:a.body.email,phone:c});d.save(function(a,c){a&&(console.log(a),b.send(a))})},exports.findAll=function(a,b){Reservation.find(function(a,c){a&&b.send(a),b.json(c)})},exports.deleteReservation=function(a,b){Reservation.findByIdAndRemove(a.params.id,function(a){a&&b.send(a)})},exports.editReservation=function(a,b){Reservation.findByIdAndUpdate(a.params.id,{$set:a.body},function(a){a&&b.send(a)})};var connection=require("../config/database"),tableSchema=require("../models/table");Table=connection.model("Table",tableSchema),exports.findAll=function(a,b,c){Table.find(function(a,c){a&&b.send(a),console.log(c),b.json(c)})};var connection=require("../config/database"),userSchema=require("../models/user");User=connection.model("User",userSchema),exports.findAll=function(a,b,c){User.find(function(a,c){a&&b.send(a),console.log(c),b.json(c)})},exports.findUserById=function(a,b){User.findById(a.params.id,function(a,c){a?b.send(a):b.json(c)})},exports.createUser=function(a,b){var c=randomPassword(),d=User({username:a.body.username,name:a.body.name,surname:a.body.surname,role:a.body.role,email:a.body.email,phone:a.body.phone,password:c,emailMessage:!0});d.save(function(a,c){a?(console.log(a),b.send(a)):User.find(function(a,c){a&&b.send(a),console.log(c),b.json(c)})})},exports.deleteUser=function(a,b){User.findByIdAndRemove(a.params.id,function(a){a&&(console.log(a),b.send(a))})},exports.editUser=function(a,b){User.findByIdAndUpdate(a.params.id,{$set:a.body},function(a){a&&(console.log(a),b.send(a))})};var mongoose=require("mongoose"),connection=require("../config/database"),dailyMenuSchema=new mongoose.Schema({foodName:{type:String,unique:!1,required:!0},foodDescription:{type:String,required:!0},foodType:{type:String,required:!0,"enum":["vegan","raw"]},foodSort:{type:String,required:!0,"enum":["polevka","hlavni"]},day:{type:String,required:!0,"enum":["pondeli","utery","streda","ctvrtek","patek"]},price:{type:Number,required:!0}});module.exports=dailyMenuSchema;var mongoose=require("mongoose"),connection=require("../config/database"),drinkMenuSchema=new mongoose.Schema({drinkName:{type:String,unique:!0,required:!0},drinkDescription:{type:String,required:!0},drinkSort:{type:String,required:!0,"enum":["caj","kava","fresh","limonada"]},price:{type:Number,required:!0}});module.exports=drinkMenuSchema;var mongoose=require("mongoose"),connection=require("../config/database"),menuSchema=new mongoose.Schema({foodName:{type:String,unique:!0,required:!0},foodDescription:{type:String,required:!1},foodType:{type:String,required:!0,"enum":["vegan","raw"]},foodSort:{type:String,required:!0,"enum":["predkrm","hlavni","salat","dezert"]},price:{type:Number,required:!0}});module.exports=menuSchema;var mongoose=require("mongoose"),connection=require("../config/database"),Schema=mongoose.Schema,ObjectId=Schema.ObjectId,reservationSchema=new mongoose.Schema({startDate:{type:Date,required:!0},endDate:{type:Date,required:!0},table:{type:ObjectId,required:!0},name:{type:String,required:!0},surname:{type:String,required:!0},email:{type:String,required:!1},phone:{type:Number,required:!0}});module.exports=reservationSchema;var mongoose=require("mongoose"),connection=require("../config/database"),tableSchema=new mongoose.Schema({name:{type:Number,required:!0,unique:!0},seatingNum:{type:String,required:!0,"enum":["two","four","six"]}});module.exports=tableSchema;var mongoose=require("mongoose"),connection=require("../config/database"),userSchema=new mongoose.Schema({username:{type:String,unique:!0,required:!0},name:{type:String,required:!0},surname:{type:String,required:!0},role:{type:String,required:!0,"enum":["admin","employee"]},password:{type:String,required:!0},email:{type:String,required:!1},emailMessage:{type:Boolean,required:!0},phone:{type:Number,required:!1},phoneMessage:{type:Boolean,required:!1},created:{type:Date,"default":Date.now}});module.exports=userSchema;